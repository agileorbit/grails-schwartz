<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Burt Beckwith">
<meta name="copyright" content="Apache License, Version 2.0">
<title>Schwartz Plugin - Reference Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Schwartz Plugin - Reference Documentation</h1>
<div class="details">
<span id="author" class="author">Burt Beckwith</span><br>
<span id="revnumber">version 1.0.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction to the Schwartz Plugin</a>
<ul class="sectlevel2">
<li><a href="#release-history">1.1. Release History</a></li>
</ul>
</li>
<li><a href="#usage">2. Usage</a>
<ul class="sectlevel2">
<li><a href="#schwartzjobfactory">2.1. SchwartzJobFactory</a></li>
<li><a href="#schwartzjob">2.2. SchwartzJob</a></li>
</ul>
</li>
<li><a href="#configuration">3. Configuration</a>
<ul class="sectlevel2">
<li><a href="#plugin-config-options">3.1. Plugin config options</a></li>
<li><a href="#quartz-config-options">3.2. Quartz config options</a></li>
</ul>
</li>
<li><a href="#comparisonWithQuartzPlugin">4. Comparison with the Quartz Plugin</a>
<ul class="sectlevel2">
<li><a href="#building-triggers">4.1. Building triggers</a></li>
<li><a href="#differences-in-default-values">4.2. Differences in default values</a></li>
<li><a href="#migrating-from-the-quartz-plugin">4.3. Migrating from the Quartz plugin</a></li>
</ul>
</li>
<li><a href="#triggers">5. Triggers</a>
<ul class="sectlevel2">
<li><a href="#using-builders-to-create-triggers">5.1. Using builders to create triggers</a></li>
<li><a href="#calendarintervalschedulebuilder">5.2. CalendarIntervalScheduleBuilder</a></li>
<li><a href="#cronschedulebuilder">5.3. CronScheduleBuilder</a></li>
<li><a href="#dailytimeintervalschedulebuilder">5.4. DailyTimeIntervalScheduleBuilder</a></li>
<li><a href="#simpleschedulebuilder">5.5. SimpleScheduleBuilder</a></li>
<li><a href="#triggerbuilder">5.6. TriggerBuilder</a></li>
<li><a href="#datebuilder">5.7. DateBuilder</a></li>
<li><a href="#builderfactory">5.8. BuilderFactory</a></li>
</ul>
</li>
<li><a href="#listeners">6. Listeners</a>
<ul class="sectlevel2">
<li><a href="#com-agileorbit-schwartz-listener-loggingjoblistener">6.1. com.agileorbit.schwartz.listener.LoggingJobListener</a></li>
<li><a href="#com-agileorbit-schwartz-listener-loggingtriggerlistener">6.2. com.agileorbit.schwartz.listener.LoggingTriggerListener</a></li>
<li><a href="#com-agileorbit-schwartz-listener-loggingschedulerlistener">6.3. com.agileorbit.schwartz.listener.LoggingSchedulerListener</a></li>
<li><a href="#com-agileorbit-schwartz-listener-exceptionprinterjoblistener">6.4. com.agileorbit.schwartz.listener.ExceptionPrinterJobListener</a></li>
<li><a href="#com-agileorbit-schwartz-listener-sessionbinderjoblistener">6.5. com.agileorbit.schwartz.listener.SessionBinderJobListener</a></li>
<li><a href="#com-agileorbit-schwartz-listener-quartzlisteners">6.6. com.agileorbit.schwartz.listener.QuartzListeners</a></li>
</ul>
</li>
<li><a href="#quartzService">7. QuartzService</a></li>
<li><a href="#tutorials">8. Tutorials</a>
<ul class="sectlevel2">
<li><a href="#basicTutorial">8.1. Basic Tutorial</a></li>
<li><a href="#jdbcJobStorageTutorial">8.2. JDBC Job Storage Tutorial</a></li>
<li><a href="#clusterTutorial">8.3. Cluster Tutorial</a></li>
</ul>
</li>
<li><a href="#advanced">9. Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#jdbcJobStorage">9.1. JDBC Job Storage</a></li>
<li><a href="#clustering">9.2. Clustering</a></li>
</ul>
</li>
<li><a href="#scriptsAndCommands">10. Scripts and Commands</a>
<ul class="sectlevel2">
<li><a href="#create-job">10.1. create-job</a></li>
<li><a href="#create-jdbc-tables-changelog">10.2. create-jdbc-tables-changelog</a></li>
<li><a href="#create-jdbc-sql">10.3. create-jdbc-sql</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">1. Introduction to the Schwartz Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Schwartz plugin integrates the <a href="http://www.quartz-scheduler.org/">Quartz Enterprize Job Scheduler</a> with Grails, making it easy to schedule and manage recurring and ad-hoc jobs for asynchronous and synchronous processing.</p>
</div>
<div class="paragraph">
<p>The plugin is similar at a high level to the <a href="https://github.com/grails-plugins/grails-quartz">Quartz</a> plugin in that it makes it easy to schedule Quartz <code>Job</code>s and <code>Trigger</code>s without having to deal directly with the Quartz API and mindset. But if you are used to working with Quartz directly you can continue to do so with this plugin - it provides convenience classes and Traits to make job scheduling easier, but you have a lot of flexibility in how you perform the various tasks.</p>
</div>
<div class="paragraph">
<p>In addition to this plugin documentation, be sure to familiarize yourself with the <a href="http://www.quartz-scheduler.org/documentation/">Quartz documentation</a>, in particular the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/configuration/">Configuration Reference</a>, the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/cookbook/">Cookbook</a>, the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/">Tutorials</a>, the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/examples/">Examples</a>, and <a href="http://www.quartz-scheduler.org/documentation/best-practices.html">Best Practices</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="20120815-145326.jpg" alt="20120815 145326">
</div>
</div>
<div class="sect2">
<h3 id="release-history">1.1. Release History</h3>
<div class="ulist">
<ul>
<li>
<p>July 12, 2016</p>
<div class="ulist">
<ul>
<li>
<p>1.0.0 release</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage">2. Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scheduling jobs in Quartz is generally done in two stages. Data about how to run your jobs (the class name and various configuration options including if the job is stateless, durable, etc.) is represented via an implementation of the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobDetail.html">JobDetail</a> interface. But there is no scheduling information there; that&#8217;s handled by classes that implement the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/Trigger.html">Trigger</a> interface. A job may have just a single <code>Trigger</code> with a configured schedule for when it fires, or it could have multiple triggers each using different schedules and possibly trigger-specific configuration. Or there might not be any triggers at all; as long as the job is durable (Quartz deletes non-durable jobs without active triggers) you can register a <code>JobDetail</code> and manually trigger the job on-demand, from other triggers, from listeners, etc.</p>
</div>
<div class="paragraph">
<p>When a trigger fires, an application class must be available to do the work, and that&#8217;s handled by a class that you create in your application that implements the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/Job.html">Job</a> interface. Often job classes are instantiated for every invocation but this isn&#8217;t a requirement, and the plugin supports using <code>Job</code> classes registered as Spring beans. If you use a singleton Spring bean be be careful not to store job-related state in the bean instance unless it won&#8217;t cause problems across multiple invocations.</p>
</div>
<div class="sect2">
<h3 id="schwartzjobfactory">2.1. SchwartzJobFactory</h3>
<div class="paragraph">
<p>The plugin includes an implementation of the Quartz <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/spi/JobFactory.html">JobFactory</a> interface, <code>SchwartzJobFactory</code>, which manages retrieving Spring bean instances when triggers fire for jobs registered as Spring beans, and instantiating new instances of POGO/POJO classes otherwise. It will also make &#8220;job data&#8221; from multiple sources available to the job classes when they&#8217;re executing.</p>
</div>
<div class="paragraph">
<p>Job data has three sources, the global values stored in the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/Scheduler.html">Scheduler</a> <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/SchedulerContext.html">SchedulerContext</a>, job-specific values from a <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobDataMap.html">JobDataMap</a> configured for the <code>JobDetail</code>, and trigger-specific <code>JobDataMap</code> instances configured for individual triggers. When you register the job in the scheduler you can include a <code>JobDataMap</code> with whatever information the job needs, or none if that isn&#8217;t needed. Likewise when scheduling triggers you can store trigger-specific data. The three sources are merged together when a trigger fires and your job instance is created or retrieved as a bean, with global values added first, then the job data, and then the trigger data. This means that job and trigger can both override values from the <code>SchedulerContext</code>, and trigger values can override job values.</p>
</div>
<div class="paragraph">
<p>If you have setters or properties in your job class corresponding to keys in the merged data map, those values will be set for each invocation. This isn&#8217;t a requirement though, and you can always access all of the merged data from the <code>JobExecutionContext</code> instance that is provided for each execution (it&#8217;s the argument in the <code>Job</code> interface <code>void execute(JobExecutionContext context)</code> method that all jobs implement).</p>
</div>
</div>
<div class="sect2">
<h3 id="schwartzjob">2.2. SchwartzJob</h3>
<div class="paragraph">
<p>The plugin includes a trait, <code>SchwartzJob</code>, which you can implement to take advantage of its default settings and configuration which will make creating, registering and managing <code>JobDetail</code> and <code>Trigger</code> instances a lot simpler. By implementing the trait, <code>QuartzService</code> can easily create a <code>JobDetail</code> instance using the implementation class as the <code>jobClass</code>, and invoking the various getter methods defined in the trait. The initial return values have sensible default values, but you can override any of them by creating the same method in your implementation class with custom values.</p>
</div>
<div class="paragraph">
<p>The trait also implements the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/InterruptableJob.html">InterruptableJob</a> interface and includes an empty <code>interrupt()</code> method that you can override for any job class that should perform some actions if they are interrupted.</p>
</div>
<div class="paragraph">
<p>Quartz requires that a <code>Job</code> that is stateful indicate that using two annotations, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/DisallowConcurrentExecution.html">DisallowConcurrentExecution</a> and <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/PersistJobDataAfterExecution.html">PersistJobDataAfterExecution</a>. You can annotate your stateful job classes with these yourself, but the plugin includes another trait, <code>StatefulSchwartzJob</code>, which simply extends <code>SchwartzJob</code> and includes these annotations. So you can just implement <code>SchwartzJob</code> or <code>StatefulSchwartzJob</code> as needed.</p>
</div>
<div class="paragraph">
<p>The trait has one abstract method, <code>buildTriggers()</code>, which is invoked from <code>afterPropertiesSet()</code> which is called by the Spring <code>ApplicationContext</code> if your job is a Spring bean after dependencies have been injected (because the trait implements <code>InitializingBean</code>). Create your job&#8217;s trigger(s) at this point and add them to the <code>triggers</code> list defined in the trait to have them auto-registered for you at startup. You can use the plugin&#8217;s builder support or the Quartz builders directly to create triggers. You don&#8217;t have to create any triggers though, and can just define an empty method; you can configure and schedule triggers yourself, or trigger jobs on-demand as needed.</p>
</div>
<div class="paragraph">
<p>Note that using these traits is not required - you can create (or reuse from non-Grails applications) job classes that implement the <code>Job</code> interface, and work directly with Quartz, creating and scheduling <code>JobDetail</code> and <code>Trigger</code> instances yourself. The traits and other helper classes are and are there to reduce the amount of manual configuration required. The plugin supports any implementation of the <code>Job</code> interface.</p>
</div>
<div class="sect3">
<h4 id="schwartzjob-method-and-property-summary">2.2.1. SchwartzJob method and property summary</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 35%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Method/Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QuartzService quartzService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency injection property for the <code>quartzService</code> bean; only valid if the job class is a Spring bean (e.g. if it&#8217;s defined in <code>grails-app/services</code> or otherwise registered in Spring). For non-bean job classes the <code>getQuartzService()</code> method will retrieve the service from the <code>ApplicationContext</code> for you.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getJobName()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the job name for the <code>JobDetail</code> that is registered for the class; the default value is the class name without the package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getJobGroup()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the job group for the <code>JobDetail</code> that is registered for the class; the default is the Quartz default (&#8220;DEFAULT&#8221;)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobKey getJobKey()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convenience method to create a <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobKey.html">JobKey</a> with the values from <code>getJobName()</code> and <code>getJobGroup()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getDescription()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the description for the <code>JobDetail</code> that is registered for the class; there is no default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getSessionRequired()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, a listener will be configured to start a GORM session before the job starts and flush and close it after it finishes (similar to the OpenSessionInView pattern used in controllers); defaults to <code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getDurable()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> the job will remain registered even if there are no active triggers associated, otherwise the <code>JobDetail</code> will be deleted by Quartz; defaults to <code>true</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getRequestsRecovery()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> jobs that are executing when the scheduler stops without being properly shut down (e.g. if the app crashes) will execute again at the next startup; defaults to <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void interrupt()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is defined in the <code>InterruptableJob</code> interface and can be overridden to add code that runs if the job is interrupted by a call to <code>scheduler.interrupt()</code>; the default implementation is empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void buildTriggers()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract in the trait and must be implemented in application job classes. Provides a hook at startup for creating triggers that should be scheduled automatically. Can be empty if you prefer to schedule triggers yourself, or if you don&#8217;t need scheduled triggers and will trigger jobs on-demand.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Trigger&gt; triggers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add triggers here in <code>buildTriggers()</code> to make them available for automatic scheduling.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TriggerBuilder builder()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a <code>TriggerBuilder</code> with the job name and group configured.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TriggerBuilder builder(String triggerName)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a <code>TriggerBuilder</code> with the job name and group configured, and with the specified trigger name set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory factory()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a <code>BuilderFactory</code> with the job name and group configured.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory factory(String triggerName)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a <code>BuilderFactory</code> with the job name and group configured, and with the specified trigger name set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobBuilder jobBuilder()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a <code>JobBuilder</code> configured from current values from the class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void updateJobDetail()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates the data in the Scheduler for the class using values from the getter methods.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void updateJobDetail(JobDetail jobDetail)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates the data in the Scheduler for the class using values from the <code>JobDetail</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobDetail getStoredJobDetail()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the current stored job detail for the class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;? extends Trigger&gt; getStoredTriggers()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieves all triggers registered for the class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date schedule(Trigger trigger)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds or updates the trigger in the scheduler, returning the next fire time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void triggerJob()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Executes the job immediately.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void triggerJob(Map jobData)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Executes the job immediately, with the specified job data available during execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QuartzService getQuartzService()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called implicitly for job classes that aren&#8217;t Spring beans to retrieve the service from the <code>ApplicationContext</code> to ensure that the service is available in methods that use it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void afterPropertiesSet()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is defined in the <code>InitializingBean</code> interface and is called by the <code>ApplicationContext</code> at startup; calls <code>buildTriggers()</code> to let classes define triggers to be automatically scheduled.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration">3. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="plugin-config-options">3.1. Plugin config options</h3>
<div class="paragraph">
<p>There are several configuration settings that you can set in the Grails config to customize various aspects of the plugin, and you can also specify Quartz configuration settings that will affect the configuration of the Scheduler, JobStore, etc.</p>
</div>
<div class="paragraph">
<p>All config options must be in the <code>quartz</code> block in <code>application.groovy</code> (or make the equivalent changes in <code>application.yml</code> if you haven&#8217;t converted it to Groovy syntax yet) but are shown here without the prefix.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.autoStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>false</code> the plugin will do all of its initialization tasks when the application starts (configuring Spring beans, registering <code>JobDetail</code>s and <code>Trigger</code>s, validation tasks, data purging if configured, etc.) but doesn&#8217;t call <code>quartzScheduler.start()</code>. This gives you a chance to do custom work after the plugin initializes but before starting the scheduler, or disabling the scheduler per-environment (e.g. in the test environment). You can manually start later by dependency injecting the Quartz scheduler bean (using <code>Scheduler quartzScheduler</code> or <code>def quartzScheduler</code>) and calling <code>quartzScheduler.start()</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.clearQuartzDataOnStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">when <code>true</code>, deletes job and trigger data from Quartz database tables (all tables except QRTZ_FIRED_TRIGGERS, QRTZ_LOCKS, and QRTZ_SCHEDULER_STATE, and filtered by scheduler name) on startup (only makes sense if jdbcStore=true)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.exposeSchedulerInRepository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> the <code>Scheduler</code> instance will be registered in the Quartz <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/SchedulerRepository.html">SchedulerRepository</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.globalJobListenerNames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'exceptionPrinterJobListener', 'loggingJobListener', 'progressTrackingListener'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Names of Spring beans that implement the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobListener.html">JobListener</a> interface that should be registered with Quartz at startup as global listeners.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.globalTriggerListenerNames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'loggingTriggerListener', 'progressTrackingListener'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Names of Spring beans that implement the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/TriggerListener.html">TriggerListener</a> interface that should be registered with Quartz at startup as global listeners.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.jdbcStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, enables storing job and trigger data in a database instead of in-memory with RAMJobStore.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.jdbcStoreDataSource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring bean name of the <code>DataSource</code> bean to use with JDBC job storage, if the bean name isn&#8217;t &#8220;dataSource&#8221;.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.pluginEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>false</code> nothing is configured, for example in the test environment so jobs aren&#8217;t firing during test execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.purgeQuartzTablesOnStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">More aggressive than <code>clearQuartzDataOnStartup</code>; if <code>true</code> all Quartz database tables are emptied at startup, bypassing Quartz APIs and simply running SQL queries to delete everything.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.schedulerListenerNames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'loggingSchedulerListener'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Names of Spring beans that implement the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/SchedulerListener.html">SchedulerListener</a> interface that should be registered with Quartz at startup as global listeners.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quartz.waitForJobsToCompleteOnShutdown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to wait for jobs to complete when the application is shutting down.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="quartz-config-options">3.2. Quartz config options</h3>
<div class="paragraph">
<p>In addition to the named config options above, the plugin generates a <code>Properties</code> instance with values that you would typically otherwise store in a <code>quartz.properties</code> file. Configuring the values in this way can be much more flexible, especially if you take advantage of Groovy syntax, and also has support for environments. Set the values in the <code>properties</code> block under in the root <code>quartz</code> block; when they&#8217;re read to populate the <code>Properties</code> instance they&#8217;re prefixed with "org.". This listing shows a fairly complete listing of the default settings for properties that are most likely to be configured. Since this mostly includes default values it doesn&#8217;t make much sense to copy this to your application&#8217;s config file - it&#8217;s here only as a reference.</p>
</div>
<div class="paragraph">
<p>Check out the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/configuration/">Quartz configuration documentation</a> for detailed information about what properties are available.</p>
</div>
<div class="listingblock">
<div class="title"><code>application.groovy</code></div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import org.quartz.core.QuartzSchedulerResources
import org.quartz.impl.DefaultThreadExecutor
import org.quartz.impl.jdbcjobstore.StdJDBCDelegate
import org.quartz.simpl.SimpleInstanceIdGenerator
import org.quartz.simpl.SimpleThreadPool

quartz {
   autoStartup = true
   clearQuartzDataOnStartup = false
   exposeSchedulerInRepository = false
   jdbcStore = false
   jdbcStoreDataSource = 'dataSource'
   purgeQuartzTablesOnStartup = false
   startupDelay = 0
   waitForJobsToCompleteOnShutdown = false

   properties {
      // RAMJobStore
      jobStore {
         misfireThreshold = 60000
      }
      // JDBC
      /*
      jobStore {
         acquireTriggersWithinLock = false // should be true if
                                           // batchTriggerAcquisitionMaxCount &gt; 1
         clusterCheckinInterval = 7500
         dontSetAutoCommitFalse = false
         dontSetNonManagedTXConnectionAutoCommitFalse = false
         driverDelegateClass = StdJDBCDelegate.name
         driverDelegateInitString = null
         isClustered = false
         lockHandler.class = null // if null Quartz will determine which to use
         maxMisfiresToHandleAtATime = 20
         misfireThreshold = 60000
         selectWithLockSQL = 'SELECT * FROM {0}LOCKS WHERE SCHED_NAME = {1}' +
                             ' AND LOCK_NAME = ? FOR UPDATE'
         tablePrefix = 'QRTZ_'
         txIsolationLevelReadCommitted = false
         txIsolationLevelSerializable = false
         useProperties = false
      }
      */
      managementRESTService {
         bind = '0.0.0.0:9889'
         enabled = false
      }
      scheduler {
         batchTriggerAcquisitionFireAheadTimeWindow = 0
         batchTriggerAcquisitionMaxCount = 1
         classLoadHelper.class = null // Quartz default is CascadingClassLoadHelper but
                                      // Spring's SchedulerFactoryBean configures a
                                      // ResourceLoaderClassLoadHelper if no value is set
         dbFailureRetryInterval = 15000
         idleWaitTime = 30000
         instanceId = 'NON_CLUSTERED'
         instanceIdGenerator.class = SimpleInstanceIdGenerator.name
         instanceName = 'QuartzScheduler'
         interruptJobsOnShutdown = false
         interruptJobsOnShutdownWithWait = false
         jmx {
            export = true // default is false
            objectName = null // if null Quartz will generate with
                              // QuartzSchedulerResources.generateJMXObjectName()
            proxy = false
            proxy.class = null
         }
         makeSchedulerThreadDaemon = false
         rmi {
            bindName = null // if null Quartz will generate with
                            // QuartzSchedulerResources.getUniqueIdentifier()
            createRegistry = QuartzSchedulerResources.CREATE_REGISTRY_NEVER // 'never'
            export = false
            proxy = false
            registryHost = 'localhost'
            registryPort = 1099
            serverPort = -1 // random
         }
         skipUpdateCheck = true
         threadName = instanceName + '_QuartzSchedulerThread'
         threadsInheritContextClassLoaderOfInitializer = false
         userTransactionURL = null
         wrapJobExecutionInUserTransaction = false
      }
      threadExecutor.class = DefaultThreadExecutor.name
      threadPool.class = SimpleThreadPool.name
      threadPool {
         makeThreadsDaemons = false
         threadCount   = 10
         threadPriority = Thread.NORM_PRIORITY // 5
         threadsInheritContextClassLoaderOfInitializingThread = false
         threadsInheritGroupOfInitializingThread = true
      }
   }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="comparisonWithQuartzPlugin">4. Comparison with the Quartz Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The two plugins are similar in many ways, but significantly different in others. Both make it easy to create a simple class that is conveniently registered with Quartz as a <code>JobDetail</code> and optionally some triggers.</p>
</div>
<div class="paragraph">
<p>The Quartz plugin abstracts away some of the details with the expectation that this makes the process simpler. I&#8217;ve found the opposite however; for the small number of keystrokes saved the abstractions used add layers of dynamic Groovy code that add little value, slow down execution (admittedly not significantly), and make working with Quartz more confusing in some cases.</p>
</div>
<div class="paragraph">
<p>Using Quartz outside of Grails in a regular Java project isn&#8217;t particularly complex. You just have to create a class for each job and implement the <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/Job.html">org.quartz.Job</a> interface which has a single method, <code>execute</code> with a single argument, a <code>JobExecutionContext</code>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import org.quartz.Job;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

public class MyJob implements Job {
   public void execute(JobExecutionContext context) throws JobExecutionException {
      // your code here
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Quartz plugin doesn&#8217;t require that your job classes implement <code>Job</code> or any interface, but simply have an <code>execute</code> method. It can take a <code>JobExecutionContext</code> argument if you have a need for it, or can be a no-arg method if not, and there is no mention of <code>JobExecutionException</code> anywhere in the documentation. A job can be (and typically is) implemented as simply as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class MyJob {

   def execute() {
      // your code here
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This certainly seems better, using a pattern that&#8217;s common in Grails and Groovy apps where Groovy and/or the framework reduce boilerplate code and let you focus on solving the problem at hand, in this case performing some actions when a trigger fires for your job. Internally the plugin has a single class that implements <code>Job</code> (and a similar second class for stateful jobs) which is the actual class registered in Quartz as the implementation class for the job. Your application&#8217;s job classes are registered as Spring beans, and the bean name is stored with the <code>JobDetail</code>, and when a trigger fires, the <code>execute()</code> method is invoked in the plugin&#8217;s job class, and your application&#8217;s job bean is retrieved from Spring to do the actual job processing work. The <code>execute()</code> method and whether it has a <code>JobExecutionContext</code> argument are looked up once using reflection at startup, and then invoked with reflection each time a trigger fires, with handling for <code>InvocationTargetException</code> and <code>IllegalAccessException</code> that&#8217;s necessary because the method is dynamically invoked.</p>
</div>
<div class="paragraph">
<p>There some other hidden costs also. In addition to the <code>execute()</code> method, you define triggers for your job using the plugin&#8217;s custom DSL in a static Closure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class MyJob {

   static triggers = {
      simple name:'simpleTrigger', startDelay: ...
   }

   def execute() {
      // your code here
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having a closure like that in the class means you cannot use the <code>CompileStatic</code> annotation at the class level, only per-method. This is a small difference and there wouldn&#8217;t be much gained if the trigger definition code was statically compiled, but in practice there tends to be little use of <code>CompileStatic</code> at all. I now use <code>CompileStatic</code> wherever I can, because of the performance boost but also because it makes writing code much faster because IDEs have a lot more information available for use with autocomplete and other inferencing features. My opinion is that plugins should be encouraging and enabling <em>more</em> use of static compilation, not implicitly discouraging it.</p>
</div>
<div class="paragraph">
<p>Hopefully your jobs will always run without errors, but exceptions occur and by ignoring the possibility that a <code>JobExecutionException</code> might be thrown during job execution also has a runtime cost. This is a checked exception, which Groovy doesn&#8217;t require us to deal with. But it implements that by wrapping checked exceptions in an <code>UndeclaredThrowableException</code>, and unwrapping them before they&#8217;re actually handled. This also affects the majority of the methods in <code>grails.plugins.quartz.QuartzJob</code> and <code>grails.plugins.quartz.JobManagerService</code>, specifically the methods that call Quartz <code>Scheduler</code> methods, most of which can throw <code>JobExecutionException</code>. Exceptions in Groovy are already slow and expensive and having a feature in a plugin that adds processing and overhead only makes the problem worse.</p>
</div>
<div class="paragraph">
<p>None of these costs are particularly bad, and in general performance is likely not noticeably different from the more verbose implementation in Java. But if a lot of work is being done in your Quartz jobs, or if they fire often, these costs can certainly add up. This could easily be shrugged off as a non-issue if the implementation savings was significant, but all we gained was the ability to omit the <code>execute()</code> method argument, omit the <code>implements Job</code> declaration, and omit the <code>JobExecutionException</code>. That&#8217;s a negligible savings (literally a few dozen keystrokes at best), especially given the potential costs.</p>
</div>
<div class="sect2">
<h3 id="building-triggers">4.1. Building triggers</h3>
<div class="paragraph">
<p>Triggers are defined statically in the Quartz plugin in a <code>triggers</code> closure in each job class, using the plugin&#8217;s trigger DSL. Only &#8220;simple&#8221; and &#8220;cron&#8221; triggers are directly supported, but you can configure any trigger type by specifying the class and all of the trigger properties as name/value pairs. The DSL is fairly limited and there is no autocompletion.</p>
</div>
<div class="paragraph">
<p>With Schwartz you also can define triggers in the job class, typically in the <code>buildTriggers()</code> method in job classes that implement <code>SchwartzJob</code> or <code>StatefulSchwartzJob</code>. There is no DSL, but instead you define triggers programmatically. As you can see from the examples throughout the documentation, using the Quartz builder classes added in Quartz 2.0, or the plugin&#8217;s <code>BuilderFactory</code> which aggregates the logic for all of the Quartz builders into one builder, the programmatic approach feels a lot like using a DSL but with the added benefit of having immediate feedback about available options and syntax when coding in an IDE. You can create different triggers or use different settings depending on the current <code>Environment</code>, get access to the <code>Config</code>, and  use any Spring bean, Grails service, etc. as needed, and the <code>QuartzService</code> is available inside all <code>SchwartzJob</code> classes. You can also create instances of the &#8220;Impl&#8221; classes directly and set properties there, for example if you already have working existing code, but this approach shouldn&#8217;t be used in general.</p>
</div>
<div class="paragraph">
<p>You can additionally create triggers outside of your job classes and schedule them on-demand, using the Quartz <code>Scheduler</code> or helper methods in <code>QuartzService</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="differences-in-default-values">4.2. Differences in default values</h3>
<div class="paragraph">
<p>When building triggers, if no value is specified the Quartz plugin defaults to a 60,000 millisecond (one minute) repeat interval, &#8220;GRAILS_JOBS&#8221; for the job group name, &#8220;GRAILS_TRIGGERS&#8221; for the trigger group name, &#8220;Grails Job&#8221; for the job description, and, inexplicably, &#8220;0 0 6 * * ?&#8221; for the CRON expression.  This plugin has no defaults for these properties (other than the job and trigger names, which default to the Quartz default value of &#8220;DEFAULT&#8221; for both).</p>
</div>
<div class="paragraph">
<p>Another difference is trigger priority; triggers created in <code>grails.plugins.quartz.TriggerUtils</code> default to a priority value of 6 (one larger than the default value of 5, presumably as an homage to Spinal Tap).</p>
</div>
<div class="paragraph">
<p>The two plugins have the same default values for start delay (0), repeat count (repeat forever), session required (<code>true</code>), durability (<code>true</code>), and recovery requested (<code>false</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-the-quartz-plugin">4.3. Migrating from the Quartz plugin</h3>
<div class="sect3">
<h4 id="migrating-config-settings">4.3.1. Migrating config settings</h4>
<div class="paragraph">
<p>The Quartz plugin&#8217;s config settings (<code>quartz.autoStartup</code>, <code>quartz.exposeSchedulerInRepository</code>, <code>quartz.jdbcStore</code>, <code>quartz.jdbcStoreDataSource</code>, <code>quartz.pluginEnabled</code>, <code>quartz.purgeQuartzTablesOnStartup</code>, and <code>quartz.waitForJobsToCompleteOnShutdown</code>) are all also used in this plugin and have the same default values, so there shouldn&#8217;t be any changes required there.</p>
</div>
</div>
<div class="sect3">
<h4 id="migrating-job-classes">4.3.2. Migrating job classes</h4>
<div class="paragraph">
<p>Quartz plugin jobs are not directly usable in the Schwartz plugin but are easily converted. The Quartz plugin includes an artifact handler that lets you (technically it requires that you) define job classes under <code>grails-app/jobs</code>. Schwartz jobs are not artifacts by default and have no dedicated class location.</p>
</div>
<div class="paragraph">
<p>The first thing to do for each job is to decide if it should be a Grails Service or not. This is optional but if your job writes to the database it should be transactional or use transactional services to do that work, and if it makes sense to do that work transactionally inside the job class then a Service is a good option.</p>
</div>
<div class="paragraph">
<p>Run the <a href="#create-job">create-job</a> script for each existing Quartz plugin job, and add the <code>--pogo</code> flag to generate the class under <code>src/main/groovy</code>, or omit the flag to generate a Service; if your Quartz plugin job is a stateful job (somewhat confusingly referred to as a non-concurrent job in the Quartz plugin docs, since concurrency is only one aspect of a stateful job) then include the <code>--stateful</code> flag, or omit it to make the generated class a stateless job:</p>
</div>
<div class="literalblock">
<div class="title">A stateless job that&#8217;s also a Service:</div>
<div class="content">
<pre>$ grails create-job &lt;classname&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">A stateless job defined in src/main/groovy:</div>
<div class="content">
<pre>$ grails create-job &lt;classname&gt; --pogo</pre>
</div>
</div>
<div class="literalblock">
<div class="title">A stateful job that&#8217;s also a Service:</div>
<div class="content">
<pre>$ grails create-job &lt;classname&gt; --stateful</pre>
</div>
</div>
<div class="literalblock">
<div class="title">A stateful job defined in src/main/groovy:</div>
<div class="content">
<pre>$ grails create-job &lt;classname&gt; --pogo --stateful</pre>
</div>
</div>
<div class="paragraph">
<p>Both plugins have the same defaults for durability, session required, requests recovery, so if you had overridden any of those, do the same in your <code>SchwarzJob</code> class by overridding the corresponding method from the trait, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">boolean getSessionRequired() { false }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also add a method override for the description, job name, and job group as needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="migrating-triggers">4.3.3. Migrating triggers</h4>
<div class="paragraph">
<p>Convert triggers defined using the Quartz plugin DSL with plugins triggers defined using this plugin&#8217;s <code>BuilderFactory</code> (either directly or by using one of the <code>factory()</code> methods defined in <code>SchwartzJob</code>) or using the Quartz builders (either directly or by using one of the <code>builder()</code> methods defined in <code>SchwartzJob</code>). Define these in the <code>buildTriggers()</code> method and add the trigger instances to the <code>triggers</code> list, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import static com.agileorbit.schwartz.builder.MisfireHandling.NowWithExistingCount
import static org.quartz.DateBuilder.todayAt

void buildTriggers() {
   triggers &lt;&lt; factory('cron every second').cronSchedule('0/1 * * * * ?').build()

   triggers &lt;&lt; factory('Repeat3TimesEvery100').intervalInMillis(100).repeatCount(3).build()

   triggers &lt;&lt; factory('repeat every 500ms forever').intervalInMillis(500).build()

   triggers &lt;&lt; factory('repeat every two days forever').intervalInDays(2).build()

   triggers &lt;&lt; factory('trigger1')
         .intervalInMillis(100)
         .startDelay(2000).noRepeat()
         .jobData(foo: 'bar').build()

   triggers &lt;&lt; factory('run_once_immediately').noRepeat().build()

   triggers &lt;&lt; factory('MisfireTrigger2')
         .intervalInMillis(150)
         .misfireHandling(NowWithExistingCount)
         .build()

   triggers &lt;&lt; factory('trigger1').group('group1').intervalInSeconds(1).build()

   triggers &lt;&lt; factory('run every day one second before midnight')
         .startAt(todayAt(23,59,59))
         .intervalInDays(1).build()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="triggers">5. Triggers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quartz includes four interfaces that extend the core <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/Trigger.html">Trigger</a> interface; <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/CalendarIntervalTrigger.html">CalendarIntervalTrigger</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/CronTrigger.html">CronTrigger</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/DailyTimeIntervalTrigger.html">DailyTimeIntervalTrigger</a>, and <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/SimpleTrigger.html">SimpleTrigger</a>. Each has a default implementation (<a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/triggers/CalendarIntervalTriggerImpl.html">CalendarIntervalTriggerImpl</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/triggers/CronTriggerImpl.html">CronTriggerImpl</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/triggers/DailyTimeIntervalTriggerImpl.html">DailyTimeIntervalTriggerImpl</a>, and <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/triggers/SimpleTriggerImpl.html">SimpleTriggerImpl</a>) and you can directly instantiate them and configure their properties yourself. They all include a few parameterized constructors but these constructors and this approach in general are deprecated in favor of using their builder classes.</p>
</div>
<div class="paragraph">
<p>The builders support a fluent API with method chaining by returning <code>this</code> from mutator methods, and you end up with readable and intuitive code to define triggers, and IDE autocompletion also greatly helps with quickly configuring settings. These include the 'core' builder <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/TriggerBuilder.html">TriggerBuilder</a> and a scheduler builder that handles the schedule-related configuration for each different trigger type (<a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/CalendarIntervalScheduleBuilder.html">CalendarIntervalScheduleBuilder</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/CronScheduleBuilder.html">CronScheduleBuilder</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/DailyTimeIntervalScheduleBuilder.html">DailyTimeIntervalScheduleBuilder</a>, and <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/SimpleScheduleBuilder.html">SimpleScheduleBuilder</a>). <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/DateBuilder.html">DateBuilder</a> is also available and has a large number of methods that help with working with dates so you don&#8217;t have to work with the frustrating Java date apis. Using these builders also tends to help avoid making invalid combinations of settings, but that&#8217;s still possible of course.</p>
</div>
<div class="sect2">
<h3 id="using-builders-to-create-triggers">5.1. Using builders to create triggers</h3>
<div class="paragraph">
<p>The general flow for creating any of the four types of triggers is to start with a call to the static <code>TriggerBuilder.newTrigger()</code> method to create the initial <code>TriggerBuilder</code> instance, and then call the various instance methods to configure job detail properties and common schedule-related properties, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">TriggerBuilder.newTrigger()
      .forJob('some job name')
      .withPriority(3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using static imports can help a lot to compact your builder code, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import static org.quartz.TriggerBuilder.newTrigger

newTrigger()
      .forJob('some job name')
      .withPriority(3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The instance methods are designed to be chained and all mutator methods return <code>this</code> instead of being <code>void</code>; this isn&#8217;t required but is the preferred way to work with the builders, so all of the examples will use this approach. At some point in the method call chain you can join in a schedule builder with a call to <code>withSchedule()</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import static org.quartz.CronScheduleBuilder.dailyAtHourAndMinute
import static org.quartz.TriggerBuilder.newTrigger

newTrigger()
      .forJob('some job name')
      .withPriority(3)
      .withSchedule(dailyAtHourAndMinute(2, 30))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The schedule builders have one or more static methods that are used to create an instance with all of the initial properties required for the particular schedule pattern. In this example I used a method that will implicitly generate a CRON expression using the three properties I provided (daily repeat, repeat hour, and repeat minute) but I could have used a different initializing method for weekly repeating, monthly, etc., or the simplest option, providing a CRON expression directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import static org.quartz.CronScheduleBuilder.cronSchedule
import static org.quartz.TriggerBuilder.newTrigger

newTrigger()
      .forJob('some job name')
      .withPriority(3)
      .withSchedule(cronSchedule('0 15 10 * * ?'))
      .build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once everything is configured, call <code>build()</code> to instantiate and configure the trigger type associated with the schedule builder you used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import org.quartz.CronTrigger

import static org.quartz.CronScheduleBuilder.dailyAtHourAndMinute
import static org.quartz.TriggerBuilder.newTrigger

CronTrigger cronTrigger = newTrigger()
      .forJob('some job name')
      .withPriority(3)
      .withSchedule(dailyAtHourAndMinute(2, 30))
      .build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The builders use generics, so in the example above no cast is needed even if your code is annotated with <code>@CompileStatic</code>.</p>
</div>
<div class="paragraph">
<p>The following sections describe the various initial static methods and subsequent instance methods for each of the builders</p>
</div>
</div>
<div class="sect2">
<h3 id="calendarintervalschedulebuilder">5.2. CalendarIntervalScheduleBuilder</h3>
<div class="sect3">
<h4 id="method-summary">5.2.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 1. CalendarIntervalScheduleBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static CalendarIntervalScheduleBuilder calendarIntervalSchedule()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 2. CalendarIntervalScheduleBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// interval, IntervalUnit

CalendarIntervalScheduleBuilder withInterval(int interval, IntervalUnit unit)
CalendarIntervalScheduleBuilder withIntervalInDays(int intervalInDays)
CalendarIntervalScheduleBuilder withIntervalInHours(int intervalInHours)
CalendarIntervalScheduleBuilder withIntervalInMinutes(int intervalInMinutes)
CalendarIntervalScheduleBuilder withIntervalInMonths(int intervalInMonths)
CalendarIntervalScheduleBuilder withIntervalInSeconds(int intervalInSeconds)
CalendarIntervalScheduleBuilder withIntervalInWeeks(int intervalInWeeks)
CalendarIntervalScheduleBuilder withIntervalInYears(int intervalInYears)

// misfireInstruction

CalendarIntervalScheduleBuilder withMisfireHandlingInstructionIgnoreMisfires()
CalendarIntervalScheduleBuilder withMisfireHandlingInstructionDoNothing()
CalendarIntervalScheduleBuilder withMisfireHandlingInstructionFireAndProceed()

// TimeZone

CalendarIntervalScheduleBuilder inTimeZone(TimeZone timezone)

// preserveHourOfDayAcrossDaylightSavings

CalendarIntervalScheduleBuilder preserveHourOfDayAcrossDaylightSavings(boolean preserveHourOfDay)

// skipDayIfHourDoesNotExist
CalendarIntervalScheduleBuilder skipDayIfHourDoesNotExist(boolean skipDay)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Corresponding BuilderFactory methods/properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Builder method</strong></th>
<th class="tableblock halign-left valign-top"><strong>BuilderFactory methods/properties</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static calendarIntervalSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A, this is always called because it&#8217;s the only static builder method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interval</code>, <code>unit</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInMinutes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInHours</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInDays</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInDays</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInWeeks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInWeeks</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInMonths</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInMonths</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInYears</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInYears</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionIgnoreMisfires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(IgnoreMisfires)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionDoNothing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(DoNothing)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionFireAndProceed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(FireAndProceed)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>preserveHourOfDayAcrossDaylightSavings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>preserveHourOfDay()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skipDayIfHourDoesNotExist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skipDay</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use these static imports when using these <code>BuilderFactory</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">grails.plugin.schwartz.builder.MisfireHandling.*
org.quartz.DateBuilder.IntervalUnit.*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cronschedulebuilder">5.3. CronScheduleBuilder</h3>
<div class="sect3">
<h4 id="method-summary-2">5.3.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 3. CronScheduleBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static CronScheduleBuilder atHourAndMinuteOnGivenDaysOfWeek(int hour, int minute, Integer... daysOfWeek)
static CronScheduleBuilder cronSchedule(CronExpression cronExpression)
static CronScheduleBuilder cronSchedule(String cronExpression)
static CronScheduleBuilder cronScheduleNonvalidatedExpression(String cronExpression)
static CronScheduleBuilder dailyAtHourAndMinute(int hour, int minute)
static CronScheduleBuilder monthlyOnDayAndHourAndMinute(int dayOfMonth, int hour, int minute)
static CronScheduleBuilder weeklyOnDayAndHourAndMinute(int dayOfWeek, int hour, int minute)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 4. CronScheduleBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// timeZone

CronScheduleBuilder inTimeZone(TimeZone timezone)

// misfireInstruction

CronScheduleBuilder withMisfireHandlingInstructionIgnoreMisfires()
CronScheduleBuilder withMisfireHandlingInstructionDoNothing()
CronScheduleBuilder withMisfireHandlingInstructionFireAndProceed()</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Corresponding BuilderFactory methods/properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Builder method</strong></th>
<th class="tableblock halign-left valign-top"><strong>BuilderFactory methods/properties</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static cronSchedule(String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cronSchedule</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static cronScheduleNonvalidatedExpression</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cronScheduleNonvalidated</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static cronSchedule(CronExpression)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cronExpression</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static dailyAtHourAndMinute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hourAndMinuteMode(DailyAt), hour, minute</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static atHourAndMinuteOnGivenDaysOfWeek</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hourAndMinuteMode(DaysOfWeek), hour, minute, days</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static weeklyOnDayAndHourAndMinute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hourAndMinuteMode(Weekly), day, hour, minute</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static monthlyOnDayAndHourAndMinute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hourAndMinuteMode(Monthly), day, hour, minute</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>inTimeZone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeZone</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionIgnoreMisfires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(IgnoreMisfires)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionDoNothing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(DoNothing)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionFireAndProceed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(FireAndProceed)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use these static imports when using these <code>BuilderFactory</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">grails.plugin.schwartz.builder.HourAndMinuteMode.*
grails.plugin.schwartz.builder.MisfireHandling.*
org.quartz.DateBuilder.SUNDAY
org.quartz.DateBuilder.MONDAY
...
org.quartz.DateBuilder.SATURDAY</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dailytimeintervalschedulebuilder">5.4. DailyTimeIntervalScheduleBuilder</h3>
<div class="sect3">
<h4 id="method-summary-3">5.4.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 5. DailyTimeIntervalScheduleBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static DailyTimeIntervalScheduleBuilder dailyTimeIntervalSchedule()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 6. DailyTimeIntervalScheduleBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// interval

DailyTimeIntervalScheduleBuilder withInterval(int interval, IntervalUnit unit)
DailyTimeIntervalScheduleBuilder withIntervalInHours(int intervalInHours)
DailyTimeIntervalScheduleBuilder withIntervalInMinutes(int intervalInMinutes)
DailyTimeIntervalScheduleBuilder withIntervalInSeconds(int intervalInSeconds)

// IntervalUnit

DailyTimeIntervalScheduleBuilder withInterval(int interval, IntervalUnit unit)

// daysOfWeek

DailyTimeIntervalScheduleBuilder onDaysOfTheWeek(Integer ... onDaysOfWeek)
DailyTimeIntervalScheduleBuilder onDaysOfTheWeek(Set&lt;Integer&gt; onDaysOfWeek)
DailyTimeIntervalScheduleBuilder onEveryDay()
DailyTimeIntervalScheduleBuilder onMondayThroughFriday()
DailyTimeIntervalScheduleBuilder onSaturdayAndSunday()

// startTimeOfDay

DailyTimeIntervalScheduleBuilder startingDailyAt(TimeOfDay timeOfDay)

// endTimeOfDay

DailyTimeIntervalScheduleBuilder endingDailyAfterCount(int count)
DailyTimeIntervalScheduleBuilder endingDailyAt(TimeOfDay timeOfDay)

// repeatCount

DailyTimeIntervalScheduleBuilder withRepeatCount(int repeatCount)

// misfireInstruction

DailyTimeIntervalScheduleBuilder withMisfireHandlingInstructionDoNothing()
DailyTimeIntervalScheduleBuilder withMisfireHandlingInstructionFireAndProceed()
DailyTimeIntervalScheduleBuilder withMisfireHandlingInstructionIgnoreMisfires()</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Corresponding BuilderFactory methods/properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Builder method</strong></th>
<th class="tableblock halign-left valign-top"><strong>BuilderFactory methods/properties</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static dailyTimeIntervalSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A, this is always called because it&#8217;s the only static builder method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interval, unit</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInSeconds</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInMinutes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInHours</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onDaysOfTheWeek(Set&lt;Integer&gt;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not used; Collections and single ints are converted to <code>Integer[]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onDaysOfTheWeek(Integer &#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>days</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onMondayThroughFriday</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mondayThroughFriday()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onSaturdayAndSunday</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>saturdayAndSunday()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onEveryDay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>everyDay()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startingDailyAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dailyStart</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endingDailyAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dailyEnd</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endingDailyAfterCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dailyEndAfterCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionIgnoreMisfires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(IgnoreMisfires)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionDoNothing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(DoNothing)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionFireAndProceed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>misfireHandling(FireAndProceed)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withRepeatCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatCount</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use these static imports when using these <code>BuilderFactory</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">grails.plugin.schwartz.builder.MisfireHandling.*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="simpleschedulebuilder">5.5. SimpleScheduleBuilder</h3>
<div class="sect3">
<h4 id="method-summary-4">5.5.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 7. SimpleScheduleBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static SimpleScheduleBuilder repeatHourlyForever()
static SimpleScheduleBuilder repeatHourlyForever(int hours)
static SimpleScheduleBuilder repeatHourlyForTotalCount(int count)
static SimpleScheduleBuilder repeatHourlyForTotalCount(int count, int hours)
static SimpleScheduleBuilder repeatMinutelyForever()
static SimpleScheduleBuilder repeatMinutelyForever(int minutes)
static SimpleScheduleBuilder repeatMinutelyForTotalCount(int count)
static SimpleScheduleBuilder repeatMinutelyForTotalCount(int count, int minutes)
static SimpleScheduleBuilder repeatSecondlyForever()
static SimpleScheduleBuilder repeatSecondlyForever(int seconds)
static SimpleScheduleBuilder repeatSecondlyForTotalCount(int count)
static SimpleScheduleBuilder repeatSecondlyForTotalCount(int count, int seconds)
static SimpleScheduleBuilder simpleSchedule()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 8. SimpleScheduleBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// interval

SimpleScheduleBuilder withIntervalInHours(int intervalInHours)
SimpleScheduleBuilder withIntervalInMilliseconds(long intervalInMillis)
SimpleScheduleBuilder withIntervalInMinutes(int intervalInMinutes)
SimpleScheduleBuilder withIntervalInSeconds(int intervalInSeconds)

// repeatCount

SimpleScheduleBuilder repeatForever()
SimpleScheduleBuilder withRepeatCount(int triggerRepeatCount)

// misfireInstruction

SimpleScheduleBuilder withMisfireHandlingInstructionFireNow()
SimpleScheduleBuilder withMisfireHandlingInstructionIgnoreMisfires()
SimpleScheduleBuilder withMisfireHandlingInstructionNextWithExistingCount()
SimpleScheduleBuilder withMisfireHandlingInstructionNextWithRemainingCount()
SimpleScheduleBuilder withMisfireHandlingInstructionNowWithExistingCount()
SimpleScheduleBuilder withMisfireHandlingInstructionNowWithRemainingCount()</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Corresponding BuilderFactory methods/properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Builder method</strong></th>
<th class="tableblock halign-left valign-top"><strong>BuilderFactory methods/properties</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static simpleSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>called if RepeatMode isn&#8217;t specified</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatMinutelyForever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Minutes), repeatForever()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatMinutelyForever(minutes)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Minutes), repeatForever(), minutes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatSecondlyForever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Seconds), repeatForever()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatSecondlyForever(seconds)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Seconds), repeatForever(), seconds</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatHourlyForever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Hours), repeatForever()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatHourlyForever(hours)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Hours), repeatForever(), hours</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatMinutelyForTotalCount(count)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Minutes), totalCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatMinutelyForTotalCount(count, minutes)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Minutes), totalCount, minutes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatSecondlyForTotalCount(count)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Seconds), totalCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatSecondlyForTotalCount(count, seconds)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Seconds), totalCount, seconds</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatHourlyForTotalCount(count)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Hours), totalCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static repeatHourlyForTotalCount(count, hours)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatMode(Hours), totalCount, hours</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInMilliseconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInSeconds</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInMinutes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIntervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>intervalInHours</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withRepeatCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatForever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repeatForever() (or omit since it&#8217;s the default)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionIgnoreMisfires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(IgnoreMisfires)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionFireNow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(FireNow)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionNextWithExistingCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(NextWithExistingCount)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionNextWithRemainingCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(NextWithRemainingCount)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionNowWithExistingCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(NowWithExistingCount)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withMisfireHandlingInstructionNowWithRemainingCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simpleMisfireHandling(NowWithRemainingCount)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use these static imports when using these <code>BuilderFactory</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">grails.plugin.schwartz.builder.SimpleMisfireHandling.*
grails.plugin.schwartz.builder.RepeatMode.*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="triggerbuilder">5.6. TriggerBuilder</h3>
<div class="sect3">
<h4 id="method-summary-5">5.6.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 9. TriggerBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static TriggerBuilder&lt;Trigger&gt; newTrigger()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 10. TriggerBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// TriggerKey

TriggerBuilder&lt;T&gt; withIdentity(String name)
TriggerBuilder&lt;T&gt; withIdentity(String name, String group)
TriggerBuilder&lt;T&gt; withIdentity(TriggerKey triggerKey)

// description

TriggerBuilder&lt;T&gt; withDescription(String triggerDescription)

// priority

TriggerBuilder&lt;T&gt; withPriority(int triggerPriority)

// calendarName

TriggerBuilder&lt;T&gt; modifiedByCalendar(String calName)

// startTime

TriggerBuilder&lt;T&gt; startAt(Date triggerStartTime)
TriggerBuilder&lt;T&gt; startNow()

// endTime

TriggerBuilder&lt;T&gt; endAt(Date triggerEndTime)

// scheduleBuilder

&lt;SBT extends T&gt; TriggerBuilder&lt;SBT&gt; withSchedule(ScheduleBuilder&lt;SBT&gt; schedBuilder)

// JobKey

TriggerBuilder&lt;T&gt; forJob(JobDetail jobDetail)
TriggerBuilder&lt;T&gt; forJob(JobKey keyOfJobToFire)
TriggerBuilder&lt;T&gt; forJob(String jobName)
TriggerBuilder&lt;T&gt; forJob(String jobName, String jobGroup)

// JobDataMap

TriggerBuilder&lt;T&gt; usingJobData(JobDataMap newJobDataMap)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, Boolean value)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, Double value)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, Float value)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, Integer value)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, Long value)
TriggerBuilder&lt;T&gt; usingJobData(String dataKey, String value)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Corresponding BuilderFactory methods/properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Builder method</strong></th>
<th class="tableblock halign-left valign-top"><strong>BuilderFactory methods/properties</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>static newTrigger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A, this is always called because it&#8217;s the only static builder method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIdentity(name)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIdentity(name, group)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name, group</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withIdentity(TriggerKey)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>triggerKey</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withDescription</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>description</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withPriority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>priority</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modifiedByCalendar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>calendarName</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startAt</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startNow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startNow()</code> (or omit since it&#8217;s the default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endAt</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>N/A</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>forJob(JobKey)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jobKey</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>forJob(jobName)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jobName</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>forJob(jobName, jobGroup)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jobName, jobGroup</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>forJob(JobDetail)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jobDetail</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, Integer)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, Long)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, Float)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, Double)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(String, Boolean)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none, use jobData Map</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>usingJobData(JobDataMap)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jobDataMap</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="datebuilder">5.7. DateBuilder</h3>
<div class="sect3">
<h4 id="method-summary-6">5.7.1. Method Summary</h4>
<div class="listingblock">
<div class="title">Listing 11. DateBuilder static methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static DateBuilder newDate()
static DateBuilder newDateInTimezone(TimeZone tz)
static DateBuilder newDateInLocale(Locale lc)
static DateBuilder newDateInTimeZoneAndLocale(TimeZone tz, Locale lc)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 12. DateBuilder instance methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// TimeZone

DateBuilder inTimeZone(TimeZone timezone)

// Locale

DateBuilder inLocale(Locale locale)

// month

DateBuilder inMonth(int inMonth)
DateBuilder inMonthOnDay(int inMonth, int onDay)

// day

DateBuilder onDay(int onDay)
DateBuilder inMonthOnDay(int inMonth, int onDay)

// year

DateBuilder inYear(int inYear)

// hour

DateBuilder atHourOfDay(int atHour)
DateBuilder atHourMinuteAndSecond(int atHour, int atMinute, int atSecond)

// minute

DateBuilder atMinute(int atMinute)
DateBuilder atHourMinuteAndSecond(int atHour, int atMinute, int atSecond)

// second

DateBuilder atSecond(int atSecond)
DateBuilder atHourMinuteAndSecond(int atHour, int atMinute, int atSecond)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 13. DateBuilder static utility methods</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static DateBuilder newDate()
static DateBuilder newDateInTimezone(TimeZone tz)
static DateBuilder newDateInLocale(Locale lc)
static DateBuilder newDateInTimeZoneAndLocale(TimeZone tz, Locale lc)

static Date dateOf(int hour, int minute, int second)
static Date dateOf(int hour, int minute, int second, int dayOfMonth, int month)
static Date dateOf(int hour, int minute, int second, int dayOfMonth, int month, int year)
static Date evenHourDate(Date date)
static Date evenHourDateAfterNow()
static Date evenHourDateBefore(Date date)
static Date evenMinuteDate(Date date)
static Date evenMinuteDateAfterNow()
static Date evenMinuteDateBefore(Date date)
static Date evenSecondDate(Date date)
static Date evenSecondDateAfterNow()
static Date evenSecondDateBefore(Date date)
static Date futureDate(int interval, IntervalUnit unit)
static Date nextGivenMinuteDate(Date date, int minuteBase)
static Date nextGivenSecondDate(Date date, int secondBase)
static Date todayAt(int hour, int minute, int second)
static Date tomorrowAt(int hour, int minute, int second)
static Date translateTime(Date date, TimeZone src, TimeZone dest)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="builderfactory">5.8. BuilderFactory</h3>
<div class="paragraph">
<p>Quartz added trigger builder classes in 2.0 that have chainable methods (the mutator methods return <code>this</code>) and provide a fluent and intuitive approach to creating triggers. In practice I found several methods to be a bit verbose, and thought it would be better in many cases to combine all of the builders so there would be a single starting point for all types of triggers. The plugin&#8217;s <code>BuilderFactory</code> (an awkward name, but certainly better than <code>BuilderBuilder</code> &#8230;&#8203;) provides this.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re building triggers inside a <code>SchwartzJob</code> class the best way to initialize a <code>BuilderFactory</code> is with one of the two <code>builder()</code> methods since they set the job name and group, and optionally the trigger name for you:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">Trigger trigger = builder('mytrigger').some().builder().methods().build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also start with just the constructor and do everything explicitly, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">Trigger trigger = new BuilderFactory().some().builder().methods().build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>All of the options in the various triggers are configurable as properties or chainable methods, so the standard Groovy Map constructor is an option also, either explicitly followed by a call to the <code>build()</code> instance method, or in one step using the static <code>build(Map)</code> method, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">Trigger trigger = BuilderFactory.build(
      name: triggerName, group: triggerGroup, jobName: jobName, jobGroup: jobGroup,
      startAt: start, endAt: end, cronSchedule: cron, timeZone: timeZone,
      description: description, jobDataMap: jobDataMap, calendarName: calendarName,
      misfireHandling: IgnoreMisfires, priority: priority)</code></pre>
</div>
</div>
<div class="paragraph">
<p>which is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">Trigger trigger = builder()
   .name(triggerName)
   .group(triggerGroup)
   .jobName(jobName)
   .jobGroup(jobGroup)
   .startAt(start)
   .endAt(end)
   .cronSchedule(cron)
   .timeZone(timeZone)
   .description(description)
   .jobDataMap(jobDataMap)
   .calendarName(calendarName)
   .priority(priority)
   .misfireHandling(IgnoreMisfires)
   .build()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because all trigger properties and methods are available when using <code>BuilderFactory</code>, it is possible to inadvertently set properties or call methods that apply to two or more trigger types; this is invalid and when you call the <code>build()</code> method, the code that validates the configured properties and determines which type of trigger to build will detect the problem and throw an exception with detailed information about what values were applicable for the different trigger types to help you to fix the mistakes.</p>
</div>
<div class="paragraph">
<p>The following tables summarize the various methods and corresponding chainable methods that are available for the different trigger types, and the common non-schedule-related methods applicable to all trigger types.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. CalendarIntervalTrigger schedule properties and methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory interval(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInDays</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInDays(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInHours(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInMinutes(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInMonths</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInMonths(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInSeconds(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInWeeks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInWeeks(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInYears</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInYears(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MisfireHandling misfireHandling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory misfireHandling(MisfireHandling _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean preserveHour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory preserveHour(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean skipDay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory skipDay(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TimeZone timeZone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory timeZone(TimeZone _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IntervalUnit unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory unit(IntervalUnit _)</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. CronTrigger schedule properties and methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CronExpression cronExpression</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory cronExpression(CronExpression _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String cronSchedule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory cronSchedule(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String cronScheduleNonvalidated</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory cronScheduleNonvalidated(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer day</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory day(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>def days</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory days(_)</code> (also <code>void setDays(daysOfWeek)</code> which accepts a single int, an <code>Integer[]</code> array, or <code>Collection</code> and converts to <code>Integer[]</code>, and <code>Integer[] getDays()</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer hour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory hour(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HourAndMinuteMode hourAndMinuteMode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory hourAndMinuteMode(HourAndMinuteMode _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer minute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory minute(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MisfireHandling misfireHandling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory misfireHandling(MisfireHandling _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TimeZone timeZone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory timeZone(TimeZone _)</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. DailyTimeIntervalTrigger schedule properties and methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TimeOfDay dailyEnd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory dailyEnd(TimeOfDay _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer dailyEndAfterCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory dailyEndAfterCount(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TimeOfDay dailyStart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory dailyStart(TimeOfDay _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>def days</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory days(_)</code> (also <code>void setDays(daysOfWeek)</code> which accepts a single int, an <code>Integer[]</code> array, or <code>Collection</code> and converts to <code>Integer[]</code>, and <code>Integer[] getDays()</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean everyDay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory everyDay(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory interval(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInHours(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInMinutes(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInSeconds(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MisfireHandling misfireHandling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory misfireHandling(MisfireHandling _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean mondayThroughFriday</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory mondayThroughFriday(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer repeatCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory repeatCount(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean saturdayAndSunday</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory saturdayAndSunday(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IntervalUnit unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory unit(IntervalUnit _)</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. SimpleTrigger properties and methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer hours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory hours(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInHours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInHours(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Long intervalInMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInMillis(long _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInMinutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInMinutes(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer intervalInSeconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory intervalInSeconds(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer minutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory minutes(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MisfireHandling misfireHandling</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory misfireHandling(MisfireHandling _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer repeatCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory repeatCount(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean repeatForever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory repeatForever(boolean _ = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RepeatMode repeatMode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory repeatMode(RepeatMode _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory seconds(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer totalCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory totalCount(int _)</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Trigger properties and methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String calendarName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory calendarName(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory description(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date endAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory endAt(Date _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory group(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SchwartzJob job</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory job(SchwartzJob _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String, ?&gt; jobData</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobData(Map&lt;String, ?&gt; _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobDataMap jobDataMap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobDataMap(JobDataMap _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobDetail jobDetail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobDetail(JobDetail _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String jobGroup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobGroup(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobKey jobKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobKey(JobKey _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String jobName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory jobName(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TriggerKey key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory key(TriggerKey _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory name(String _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer priority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory priority(int _)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date startAt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory startAt(Date _)</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Utility methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory startDelay(int millis)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chainable builder method that sets the start time of the trigger as the current time plus the specified milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void setStartDelay(int millis)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Traditional setter method that sets the start time of the trigger as the current time plus the specified milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory startNow()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Essentially a no-op since the default start date is <code>new Date()</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuilderFactory noRepeat()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resets the repeat count to zero (the default is to repeat forever)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="listeners">6. Listeners</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The plugin includes a few implementations of the Quartz listener interfaces and support for others. The listeners are all enabled by default but can be disabled (and additional listeners can be enabled) in the <a href="#configuration">Configuration</a>.</p>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-loggingjoblistener">6.1. com.agileorbit.schwartz.listener.LoggingJobListener</h3>
<div class="paragraph">
<p>Implements <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobListener.html">JobListener</a> and logs current state information at the debug level for each method.</p>
</div>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-loggingtriggerlistener">6.2. com.agileorbit.schwartz.listener.LoggingTriggerListener</h3>
<div class="paragraph">
<p>Implements <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/TriggerListener.html">TriggerListener</a> and logs current state information at the debug level for each method.</p>
</div>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-loggingschedulerlistener">6.3. com.agileorbit.schwartz.listener.LoggingSchedulerListener</h3>
<div class="paragraph">
<p>Implements <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/SchedulerListener.html">SchedulerListener</a> and logs method parameter data at the debug level for each method.</p>
</div>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-exceptionprinterjoblistener">6.4. com.agileorbit.schwartz.listener.ExceptionPrinterJobListener</h3>
<div class="paragraph">
<p>Implements <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobListener.html">JobListener</a> and logs the <code>JobKey</code> and the exception stacktrace if an exception occurs while a job is executing.</p>
</div>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-sessionbinderjoblistener">6.5. com.agileorbit.schwartz.listener.SessionBinderJobListener</h3>
<div class="paragraph">
<p>Implements <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/JobListener.html">JobListener</a> and works like the web-tier open-session-in-view pattern, binding a GORM session before your job starts and closing it when it finishes. Will be active for each <code>SchwartzJob</code> only if the job class returns <code>true</code> from its <code>getSessionRequired()</code> method (defaults to <code>true</code>) defined in the trait.</p>
</div>
</div>
<div class="sect2">
<h3 id="com-agileorbit-schwartz-listener-quartzlisteners">6.6. com.agileorbit.schwartz.listener.QuartzListeners</h3>
<div class="paragraph">
<p>Aggregate interface that implements <code>JobListener</code>, <code>TriggerListener</code>, and <code>SchedulerListener</code>. <code>com.agileorbit.schwartz.listener.QuartzListenersAdaptor</code> is an adaptor class that implements <code>QuartzListeners</code> and delegates each method to the corresponding method in an instance of <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/listeners/JobListenerSupport.html">JobListenerSupport</a>, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/listeners/SchedulerListenerSupport.html">SchedulerListenerSupport</a>, or  <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/listeners/TriggerListenerSupport.html">TriggerListenerSupport</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quartzService">7. QuartzService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The plugin includes a utility service, <code>quartzService</code>, that it uses internally for much of the interaction with the Quartz <code>Scheduler</code> and other tasks, and you can also use it in your application. Add a dependency injection for the service like for any Spring bean (<code>QuartzService quartzService</code> or <code>def quartzService</code>). The service&#8217;s methods are described below.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Method</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>init</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called from <code>doWithApplicationContext()</code> at startup; should not be called from application code.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validateTables</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks that the required tables exist if JDBC storage is enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validateExistingJobs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks that all JobDetails can be retrieved to catch problems early such as deleted/moved/renamed Job classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheduleJobs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registers a <code>JobDetail</code> and schedules triggers for each Spring bean that implements <code>SchwartzJob</code>; should not be called from application code.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheduleJob</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Builds and registers a <code>JobDetail</code> with values from a <code>SchwartzJob</code> instance and and schedules the job&#8217;s triggers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateJobDetail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces data for an existing <code>JobDetail</code> with new values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getStoredJobDetail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieves the <code>JobDetail</code> stored for a job if one exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>triggerJob</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggers a job to run immediately.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getTriggers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the triggers scheduled for a a job.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheduleTrigger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register a <code>Trigger</code> in the <code>Scheduler</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>purgeTables</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes data from all database tables; called at startup if <code>purgeQuartzTablesOnStartup</code> is <code>true</code> but can be called on-demand also.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clearData</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses standard Quartz functionality to clear job and trigger data (all tables except QRTZ_FIRED_TRIGGERS, QRTZ_LOCKS, and QRTZ_SCHEDULER_STATE).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tableNamePrefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Looks up the database table name prefix if set in the config and returns the default (&#8220;QRTZ_&#8221;) if not overridden.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="tutorials">8. Tutorials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="basicTutorial">8.1. Basic Tutorial</h3>
<div class="sect3">
<h4 id="create-your-grails-application">8.1.1. Create your Grails application.</h4>
<div class="literalblock">
<div class="content">
<pre>$ grails create-app schwartztest
$ cd schwartztest</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="install-the-plugin-by-adding-it-to-build-gradle">8.1.2. &#8220;Install&#8221; the plugin by adding it to build.gradle</h4>
<div class="paragraph">
<p>Add a dependency for the plugin by adding it to the <code>dependencies</code> block in build.gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">buildscript {
   repositories {
      ...
   }
   dependencies {
      classpath "org.grails:grails-gradle-plugin:$grailsVersion"
      ...
      classpath 'com.agileorbit:schwartz:1.0.0'
   }
}

dependencies {
   ...
   compile 'com.agileorbit:schwartz:1.0.0'
   ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-job-that-s-a-transactional-service">8.1.3. Create a job that&#8217;s a transactional service</h4>
<div class="paragraph">
<p>Next we&#8217;ll create some job classes. First, we&#8217;ll create a job that&#8217;s a transactional service:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job Skroob</pre>
</div>
</div>
<div class="paragraph">
<p>Note that even though Schwartz jobs aren&#8217;t Grails artifacts and there is no enforced naming convention, the <a href="#create-job">create-job</a> script adds the &#8220;Job&#8221; suffix for you if the specified name doesn&#8217;t end in &#8220;Job&#8221;, and &#8220;JobService&#8221; when creating jobs in <code>grails-app/services</code>, but this is not a requirement (other than the general Grails requirement that service names end in &#8220;Service&#8221;), just a convenience.</p>
</div>
<div class="paragraph">
<p>The script will create the class under <code>grails-app/services</code> in the specified package, or in the default package if none is specified (as in this case), with commented-out example triggers that aren&#8217;t shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import com.agileorbit.schwartz.SchwartzJob
import grails.transaction.Transactional
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException

@CompileStatic
@Slf4j
class SkroobJobService implements SchwartzJob {

   @Transactional
   void execute(JobExecutionContext context) throws JobExecutionException {
   }

   void buildTriggers() {
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Edit the file to add a simple trigger that fires every second, and a println in the <code>execute</code> method to verify that it&#8217;s working:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import com.agileorbit.schwartz.SchwartzJob
import grails.transaction.Transactional
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException

@CompileStatic
@Slf4j
class SkroobJobService implements SchwartzJob {

   @Transactional
   void execute(JobExecutionContext context) throws JobExecutionException {
      println "$context.trigger.key/$context.jobDetail.key at ${new Date()}"
   }

   void buildTriggers() {
      triggers &lt;&lt; factory('Skroob_EverySecond').intervalInSeconds(1).build()
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the application to verify that the job is registered and that it fires every second.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-stateful-job-that-s-a-pogo">8.1.4. Create a stateful job that&#8217;s a POGO</h4>
<div class="paragraph">
<p>This is really two steps in one since a job can be stateful or stateless, and a service or defined in <code>src/main/groovy</code> as a POGO, but we&#8217;ll create one job to reduce the overall length of this tutorial.</p>
</div>
<div class="paragraph">
<p>Run this to create the job:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job DarkHelmet --pogo --stateful</pre>
</div>
</div>
<div class="paragraph">
<p>which will be generated in <code>src/main/groovy/schwartztest/DarkHelmetJob.groovy</code> (shown here with comments removed):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import com.agileorbit.schwartz.StatefulSchwartzJob
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException
import org.springframework.stereotype.Component

@CompileStatic
@Component
@Slf4j
class DarkHelmetJob implements StatefulSchwartzJob {

   void execute(JobExecutionContext context) throws JobExecutionException {
   }

   void buildTriggers() {
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, add a trigger in <code>buildTriggers()</code> and a println statement in <code>execute()</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import com.agileorbit.schwartz.StatefulSchwartzJob
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException
import org.springframework.stereotype.Component

@CompileStatic
@Component
@Slf4j
class DarkHelmetJob implements StatefulSchwartzJob {

   void execute(JobExecutionContext context) throws JobExecutionException {
      println "$context.trigger.key/$context.jobDetail.key at ${new Date()}"
   }

   void buildTriggers() {
      triggers &lt;&lt; factory('DarkHelmet_Every2Second').intervalInSeconds(2).build()
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this is not a service, it won&#8217;t be automatically discovered by the plugin and won&#8217;t be registered in Quartz, but there are a few options. Note that the class is annotated with the Spring <a href="http://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/stereotype/Component.html">Component</a> annotation; this is not required and can be removed, but if you&#8217;ve enabled component scanning, e.g. by annotating your <code>Application</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import grails.boot.GrailsApp
import grails.boot.config.GrailsAutoConfiguration
import groovy.transform.CompileStatic
import org.springframework.context.annotation.ComponentScan

@CompileStatic
@ComponentScan('schwartztest')
class Application extends GrailsAutoConfiguration {
   static void main(String[] args) {
      GrailsApp.run this, args
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then your job class will be registered as a Spring bean and because it implements <code>SchwartzJob</code> it will be auto-registered in Quartz at startup.</p>
</div>
<div class="paragraph">
<p>If you prefer, you can register the job as a Spring bean in <code>grails-app/conf/spring/resources.groovy</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import schwartztest.DarkHelmetJob

beans = {
   darkHelmetJob(DarkHelmetJob) {
      quartzService = ref('quartzService')
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-non-bean-job">8.1.5. Create a non-bean job</h4>
<div class="paragraph">
<p>There&#8217;s no requirement that jobs be registered as Spring beans, it&#8217;s just a convenience. You can manage job registration and scheduling entireley yourself if you prefer. Run the <code>create-job</code> script again to create a POGO job class:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job Barf --pogo</pre>
</div>
</div>
<div class="paragraph">
<p>and add a println statement in <code>execute()</code> but don&#8217;t create any triggers, and delete the <code>Component</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package schwartztest

import com.agileorbit.schwartz.SchwartzJob
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException

@CompileStatic
@Slf4j
class BarfJob implements SchwartzJob {

   void execute(JobExecutionContext context) throws JobExecutionException {
      println "$context.trigger.key/$context.jobDetail.key at ${new Date()}"
   }

   void buildTriggers() {
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you have several options. You could manually register the job yourself, e.g. in <code>BootStrap</code> (or later at runtime, e.g. in a service):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.agileorbit.schwartz.QuartzService
import org.quartz.SchedulerException
import schwartztest.BarfJob

class BootStrap {

   QuartzService quartzService

   def init = {
      BarfJob job = new BarfJob()
      try {
         quartzService.scheduleJob job
      }
      catch (SchedulerException e) {
         log.error e.message, e
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or you could create a <code>JobDetail</code> and optionally some triggers and register the job using those (and you could do the same for other job classes that implement <code>Job</code> but not <code>SchwartzJob</code>, even Java classes):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.agileorbit.schwartz.QuartzService
import org.quartz.JobDetail
import org.quartz.SchedulerException
import org.quartz.Trigger
import schwartztest.BarfJob

class BootStrap {

   QuartzService quartzService

   def init = {

      BarfJob job = new BarfJob()

      JobDetail jobDetail = job.jobBuilder().build()
      Collection&lt;? extends Trigger&gt; triggers = ...

      try {
         quartzService.scheduleJob jobDetail, triggers, false
      }
      catch (SchedulerException e) {
         log.error e.message, e
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the job is registered, you can trigger the job to run immediately whenever you want:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.agileorbit.schwartz.QuartzService
import static org.quartz.JobKey.jobKey

class SomeService {

   QuartzService quartzService

   void someMethod() {
      quartzService.triggerJob jobKey('BarfJob')
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jdbcJobStorageTutorial">8.2. JDBC Job Storage Tutorial</h3>
<div class="paragraph">
<p>There&#8217;s not much to do to change from in-memory job storage to database storage, but be sure to read the <a href="#jdbcJobStorage">JDBC Job Storage</a> section of the docs before starting this tutorial.</p>
</div>
<div class="paragraph">
<p>In this example MySQL is used but you can use any of the database types supported by Quartz. Very few details are database-specific, primarily just the initial database creation steps.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t already have a MySQL database to work with, run these commands in a MySQL client as the root user or another user with permission to create databases and grant permissions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sql" data-lang="sql">&gt; create database quartz_jdbc_test;

&gt; grant all on quartz_jdbc_test.* to quartztest@localhost identified by 'quartztest';</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="configure-the-datasource">8.2.1. Configure the DataSource</h4>
<div class="paragraph">
<p>Add a dependency in <code>build.gradle</code> for the JDBC driver for your database (be sure to use the latest version available):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
   ...
   runtime 'mysql:mysql-connector-java:5.1.39'
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and update <code>application.groovy</code> (or make the equivalent changes in <code>application.yml</code> if you haven&#8217;t converted it to Groovy syntax yet) to use the correct driver class, dialect, url, username, and password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dataSource {
   ...
   dialect = org.hibernate.dialect.MySQL5InnoDBDialect
   driverClassName = 'com.mysql.jdbc.Driver'
   password = 'quartztest'
   url = 'jdbc:mysql://localhost/quartz_jdbc_test'
   username = 'quartztest'
   ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-the-database-tables">8.2.2. Create the database tables</h4>
<div class="paragraph">
<p>You&#8217;ll need to create the database tables that Quartz uses to store job and trigger information. As described in the <a href="#jdbcJobStorage">JDBC Job Storage</a> section there are three options, using one of the Quartz scripts from the full distribution, or using one of the plugin commands. Use whichever approach you prefer and apply the changelog or execute the SQL to create the tables.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using the database-migration plugin (or Liquibase directly), you should use the <a href="#create-jdbc-tables-changelog">create-jdbc-tables-changelog</a> command, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-tables-changelog grails-app/migrations/quartz_jdbc.groovy</pre>
</div>
</div>
<div class="paragraph">
<p>Add the file to your main changelog file and run</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails dbm-update</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#create-jdbc-sql">create-jdbc-sql</a> command is similar but only has a dependency on Hibernate. Run the script to generate the SQL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-sql quartz_jdbc.sql</pre>
</div>
</div>
<div class="paragraph">
<p>and use the MySQL client or another tool to run the SQL statements and create the tables.</p>
</div>
</div>
<div class="sect3">
<h4 id="enable-database-storage">8.2.3. Enable database storage</h4>
<div class="paragraph">
<p>Once the database tables are available, set the <code>jdbcStore</code> config property to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since MySQL uses the default <code>DriverDelegate</code>, it&#8217;s not required to specify the delegate class name, but if you&#8217;re using a database that has a custom implementation (e.g. PostgreSQL) then you would also set that, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import org.quartz.impl.jdbcjobstore.PostgreSQLDelegate

quartz {
   jdbcStore = true
   properties {
      jobStore {
         driverDelegateClass = PostgreSQLDelegate.name
      }
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="clusterTutorial">8.3. Cluster Tutorial</h3>
<div class="paragraph">
<p>Be sure to read the <a href="#clustering">Clustering</a> section of the docs before starting this tutorial.</p>
</div>
<div class="sect3">
<h4 id="configure-database-job-storage">8.3.1. Configure database job storage</h4>
<div class="paragraph">
<p>Database job storage is required before configuring a Quartz cluster, so configure that first using the <a href="#jdbcJobStorageTutorial">JDBC Job Storage Tutorial</a> (or by making the required changes in an existing application).</p>
</div>
</div>
<div class="sect3">
<h4 id="enable-clustering">8.3.2. Enable clustering</h4>
<div class="paragraph">
<p>Next, enable clustering by setting <code>isClustered</code> to <code>true</code> in the config, and set the <code>instanceName</code> property to define the name for the cluster. For now, also set the value for <code>instanceId</code> to &#8220;AUTO&#8221; to let Quartz assign a unique value for each server node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
   properties {
      jobStore {
         isClustered = true
      }
      scheduler {
         instanceId = 'AUTO'
         instanceName = 'ClusterTutorial'
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="start-the-app">8.3.3. Start the app</h4>
<div class="paragraph">
<p>Enable logging for the Quartz classes in <code>logback.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">logger 'org.quartz', INFO</code></pre>
</div>
</div>
<div class="paragraph">
<p>and start the app and you should see output similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>INFO org.quartz.core.QuartzScheduler - Quartz Scheduler v.2.2.3 created.
INFO org.quartz.core.QuartzScheduler - Scheduler meta-data: Quartz Scheduler (v2.2.3) 'ClusterTutorial' with instanceId '...'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.springframework.scheduling.quartz.LocalDataSourceJobStore' - which supports persistence. and is clustered.
INFO org.quartz.core.QuartzScheduler - Scheduler ClusterTutorial_$_... started.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-simple-job">8.3.4. Create a simple job</h4>
<div class="paragraph">
<p>Stop the app and create a simple job that we can use to verify that clustering is enabled and working:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job ClusterTest</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package clustertest

import com.agileorbit.schwartz.SchwartzJob
import grails.transaction.Transactional
import groovy.transform.CompileStatic
import groovy.util.logging.Slf4j
import org.quartz.JobExecutionContext
import org.quartz.JobExecutionException

@CompileStatic
@Slf4j
class ClusterTestJobService implements SchwartzJob {

   @Transactional
   void execute(JobExecutionContext context) throws JobExecutionException {
      println "$context.trigger.key/$context.jobDetail.key at ${new Date()}"
   }

   void buildTriggers() {
      triggers &lt;&lt; factory('ClusterTest_EverySecond').intervalInSeconds(1).build()
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="run-two-instance-to-check-that-clustering-is-configured">8.3.5. Run two instance to check that clustering is configured</h4>
<div class="paragraph">
<p>Start the app again and verify that the job fires and prints to the console every second:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails run-app --port=8081</pre>
</div>
</div>
<div class="paragraph">
<p>Open a second terminal and run a second instance of the app on another port and verify that the job runs in both instances, but that each time the trigger fires it only executes on one of the running instances:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails run-app --port=8082</pre>
</div>
</div>
<div class="paragraph">
<p>Quartz makes no guarantees about load distribution among cluster nodes and in general will tend to run jobs on the first instance they happen to run on, so you may not see any output in the second window. But if you stop the first server instance (either with a clean shutdown or more forcibly) then you will definitely see that the job starts firing on the second instance, possibly after a delay of a few seconds.</p>
</div>
</div>
<div class="sect3">
<h4 id="change-from-automatic-instance-ids-to-explicitly-set-values">8.3.6. Change from automatic instance ids to explicitly set values</h4>
<div class="paragraph">
<p>Edit <code>application.groovy</code> and remove the <code>instanceId</code> setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
   properties {
      jobStore {
         isClustered = true
      }
      scheduler {
         instanceName = 'ClusterTutorial'
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and add this block to <code>build.gradle</code> to enable passing system properties from the commandline:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">configure(bootRun) {
   systemProperties System.properties
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the two instances again, but this time passing the cluster node id in addition to the server port:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails -Dquartz.properties.scheduler.instanceId=node1 run-app --port=8081</pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails -Dquartz.properties.scheduler.instanceId=node2 run-app --port=8082</pre>
</div>
</div>
<div class="paragraph">
<p>and you should see from the logging output that clustering is enabled and that the specified node names are used instead of randomly assigned values, and that the work of running the sample job is split between the two instances.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advanced">9. Advanced Topics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="jdbcJobStorage">9.1. JDBC Job Storage</h3>
<div class="paragraph">
<p>The default implementation of the Quartz <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/spi/JobStore.html">JobStore</a> is <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/simpl/RAMJobStore.html">RAMJobStore</a> which keeps everything in-memory at the server where the schedular is running. This works well when you only have one server but when you need to scale beyond one, or run multiple instances for high availability, it&#8217;s important to both spread the workload between the servers and to ensure that triggers only fire on one machine, and for that you need centralized storage. Using Quartz&#8217;s support for storage in a relational database is one good option, and Quartz also supports using Terracotta as the <code>JobStore</code>.</p>
</div>
<div class="paragraph">
<p>The initial configuration to change from in-memory to a database is only a few steps, and there are many optional tuning and configuration options described in <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/configuration/ConfigJobStoreCMT.html">the documentation</a>.</p>
</div>
<div class="paragraph">
<p>One step when using traditional Quartz outside of Grails is deciding what transaction support to use; <code>JobStoreTX</code> manages transactions for Quartz table updates but cannot participate in your application&#8217;s transactions, or <code>JobStoreCMT</code> which uses the transaction support from the application server or framework and can update Quartz tables transactionally along with application table updates. You also would add connection and pool-management properties to the Quartz configuration to create a DataSource that Quartz uses for its queries.</p>
</div>
<div class="paragraph">
<p>Spring provides a third option with its <a href="http://docs.spring.io/spring/docs/4.2.x/javadoc-api//org/springframework/scheduling/quartz/LocalDataSourceJobStore.html">LocalDataSourceJobStore</a> implementation which uses the application&#8217;s DataSource (or one of them if there are multiple) and existing transaction support, which lets Quartz updates use the same transaction support as the rest of the application. This is the option used by the plugin, and to enable it you simply set the DataSource as a property of the <a href="http://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/scheduling/quartz/SchedulerFactoryBean.html">SchedulerFactoryBean</a> Spring bean. The plugin will do this for you if you set the <code>quartz.jdbcStore</code> config value to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default it will use the <code>dataSource</code> Spring bean, and to use a different DataSource bean, set its name in the <code>quartz.jdbcStoreDataSource</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
   jdbcStoreDataSource = 'someOtherDataSource'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use this approach, do not configure the <code>org.quartz.jobStore.class</code> Quartz property or any values for a connection pool as described in the Quartz JDBC documentation - the plugin and the Spring support classes make the appropriate config changes when creating the Scheduler and its support objects.</p>
</div>
<div class="sect3">
<h4 id="database-tables">9.1.1. Database tables</h4>
<div class="paragraph">
<p>You&#8217;ll need to create the database tables that Quartz uses to store job and trigger information, and there are a few different options available. The full Quartz distribution (available to download from <a href="http://www.quartz-scheduler.org/downloads/">the Quartz website</a>) contains files with SQL statements for many popular databases. In addition, the plugin includes two commands that will create a Liquibase changelog or the equivalent SQL for you. Use whichever of these approaches you prefer and apply the changelog or execute the SQL to create the tables.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using the database-migration plugin (or Liquibase directly), you should use the <a href="#create-jdbc-tables-changelog">create-jdbc-tables-changelog</a> command, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-tables-changelog grails-app/migrations/quartz_jdbc.groovy</pre>
</div>
</div>
<div class="paragraph">
<p>Add the file to your main changelog file and run</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails dbm-update</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#create-jdbc-sql">create-jdbc-sql</a> command is similar but only has a dependency on Hibernate. Run the script to generate the SQL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-sql quartz_jdbc.sql</pre>
</div>
</div>
<div class="paragraph">
<p>and use the client for you database or another tool to run the SQL statements and create the tables.</p>
</div>
</div>
<div class="sect3">
<h4 id="driverdelegate">9.1.2. DriverDelegate</h4>
<div class="paragraph">
<p>Quartz needs to know which <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/DriverDelegate.html">DriverDelegate</a> implementation that the <code>JobStore</code> will use to perform the actual queries and updates. This is similar to the <code>Dialect</code> concept in Hibernate, and allows the core functionality to focus on the logic around job management and delegates database-specific JDBC work to a specialized helper class. Some databases use the default implementation, <a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/StdJDBCDelegate.html">StdJDBCDelegate</a>, but there are custom implementations for databases that require different logic for various calls. The following table summarizes which class to use for several popular databases but check with the online documentation to be sure to select the correct type for the database you&#8217;re using:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DriverDelegate Class</strong></th>
<th class="tableblock halign-left valign-top"><strong>Database(s)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/StdJDBCDelegate.html">StdJDBCDelegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H2, Informix, MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/DB2v6Delegate.html">DB2v6Delegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DB2 6.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/DB2v7Delegate.html">DB2v7Delegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DB2 7.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/DB2v8Delegate.html">DB2v8Delegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DB2 8.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/MSSQLDelegate.html">MSSQLDelegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/oracle/OracleDelegate.html">OracleDelegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.quartz-scheduler.org/api/2.2.1/org/quartz/impl/jdbcjobstore/PostgreSQLDelegate.html">PostgreSQLDelegate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The default is <code>StdJDBCDelegate</code> so if your database uses that you don&#8217;t need to make any changes. If you&#8217;re using one of the databases that has a custom driver delegate implementation, specify the class name in the config in the <code>driverDelegateClass</code> setting, e.g. for PostgreSQL you would use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import org.quartz.impl.jdbcjobstore.PostgreSQLDelegate

quartz {
   jdbcStore = true
   properties {
      jobStore {
         driverDelegateClass = PostgreSQLDelegate.name
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several other JDBC-related config options, so familiarize yourself with those in case they can be of use, but the defaults should work well in general for most of the properties. The properties all start with &#8220;org.quartz.jobStore.&#8221;, e.g. &#8220;org.quartz.jobStore.tablePrefix&#8221;, &#8220;org.quartz.jobStore.txIsolationLevelSerializable&#8221;, etc. so they would be set in the &#8220;quartz.properties.jobStore&#8221; config block, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   ...
   properties {
      jobStore {
         acquireTriggersWithinLock = ...
         clusterCheckinInterval = ...
         ...
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To summarize, the general steps to change job storage from in-memory to JDBC are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>execute the SQL statements (from one of the Quartz example files or using one of the plugin commands) to create the tables and indexes</p>
</li>
<li>
<p>set <code>quartz.jdbcStore</code> to <code>true</code> in the config</p>
</li>
<li>
<p>set <code>quartz.driverDelegateClass</code> to the name of the <code>DriverDelegate</code> used by your database if it&#8217;s not the default</p>
</li>
<li>
<p>optionally specify a non-default DataSource bean name for <code>quartz.jdbcStoreDataSource</code></p>
</li>
<li>
<p>optionally configure additional properties</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="clustering">9.2. Clustering</h3>
<div class="paragraph">
<p>Clustering is a moderately complex topic and you should read the <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x//configuration/ConfigJDBCJobStoreClustering.html">Quartz clustering documentation</a> before trying to implement it, but there are only a few required steps to get basic clustering working.</p>
</div>
<div class="paragraph">
<p>The first is to configure storage of job data in a database, so refer to the previous section for those steps.</p>
</div>
<div class="paragraph">
<p>In addition, you must enable clustering with the <code>isClustered</code> config setting, and choose a shared cluster name by setting the <code>instanceName</code> config setting, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
   properties {
      jobStore {
         isClustered = true
      }
      scheduler {
         instanceName = 'cluster_tutorial'
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The remaining required config setting is a unique instance id for each node in the cluster, using the <code>instanceId</code> config setting. You can let Quartz assign a unique name for each node automatically by using the value &#8220;AUTO&#8221;, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">quartz {
   jdbcStore = true
   properties {
      jobStore {
         isClustered = true
      }
      scheduler {
         instanceName = 'cluster_tutorial'
         instanceId = 'AUTO'
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>but if you want to choose the values yourself you would omit that setting from <code>application.groovy</code> and set the value externally for each server instance.</p>
</div>
<div class="paragraph">
<p>That&#8217;s all that&#8217;s required, but refer to the Quartz docs for information about the various optional config settings that are available, and try out the <a href="#clusterTutorial">Cluster Tutorial</a> to see clustering in action.</p>
</div>
<div class="paragraph">
<p>To summarize, the general steps to change job storage from in-memory to JDBC are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>configure database job storage</p>
</li>
<li>
<p>set <code>quartz.properties.jobStore.isClustered</code> to <code>true</code> in the config</p>
</li>
<li>
<p>set <code>quartz.properties.scheduler.instanceName</code> to the cluster name in the config</p>
</li>
<li>
<p>set <code>quartz.properties.scheduler.instanceId</code> to &#8216;AUTO&#8217; in the config to use auto-generated unique node names, or specify the value externally for each node</p>
</li>
<li>
<p>optionally configure additional properties</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scriptsAndCommands">10. Scripts and Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The plugin must be in the Gradle classpath in order for the scripts and commands to be available from the commandline. Be sure to include a &#8220;classpath&#8221; element in the <code>dependencies</code> section of the <code>buildscript</code> block in your application&#8217;s <code>build.gradle</code> to make the script available to Gradle, in addition to adding a regular &#8220;compile&#8221; element in the main <code>dependencies</code> block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">buildscript {
   repositories {
      ...
   }
   dependencies {
      classpath "org.grails:grails-gradle-plugin:$grailsVersion"
      ...
      classpath 'com.agileorbit:schwartz:1.0.0'
   }
}

dependencies {
   ...
   compile 'com.agileorbit:schwartz:1.0.0'
   ...
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="create-job">10.1. create-job</h3>
<div class="paragraph">
<div class="title">Purpose</div>
<p>Creates a new Quartz Job class. The general format is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job JOB_CLASS_NAME [--pogo] [--stateful]</pre>
</div>
</div>
<div class="literalblock">
<div class="title">Examples</div>
<div class="content">
<pre>$ grails create-job report</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job com.mycompany.foo.priceUpdate --pogo</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job com.mycompany.foo.priceUpdate --stateful</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-job com.mycompany.foo.priceUpdate --pogo --stateful</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>Creates a class with the specified class name and package that implements either <code>SchwartzJob</code> or <code>StatefulSchwartzJob</code>. By default it will create a stateless class but will make it stateful if you include the <code>--pogo</code> flag.</p>
</div>
<div class="paragraph">
<p>By default the class will be generated as a Grails Service under <code>grails-app/services</code>, but if you include the <code>--pogo</code> flag the class will be generated under <code>src/main/groovy</code>. The plugin doesn&#8217;t automatically register your job classes as Spring beans, but often job classes need to access the database or call services and other Spring beans. By making your class a Grails Service you get support for dependency injection and can easily make your job class transactional with the <code>Transactional</code> annotation. All beans that implement one of the traits will be auto-discovered at startup by <code>QuartzService</code> and a <code>JobDetails</code> and any configured <code>Trigger</code> instances will be registered in the Quartz <code>Scheduler</code> if they are not already.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-jdbc-tables-changelog">10.2. create-jdbc-tables-changelog</h3>
<div class="paragraph">
<div class="title">Purpose</div>
<p>Creates a Liquibase changelog (or the SQL generated from a changelog) to create Quartz database tables. The general format is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-tables-changelog [FILENAME]</pre>
</div>
</div>
<div class="literalblock">
<div class="title">Examples</div>
<div class="content">
<pre>$ grails create-jdbc-tables-changelog grails-app/migrations/quartz_jdbc.groovy</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-tables-changelog grails-app/migrations/quartz_jdbc.xml</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-tables-changelog quartz_jdbc.sql</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>Creates in-memory Liquibase model objects and builds a changelog from those in Groovy or XML format (or any format supported by Liquibase). Will optionally generate the resulting SQL from the changelog. The format is determined by the extension of the file you specify; if it is &#8220;groovy&#8221;, &#8220;xml&#8221;, or any of the file formats supported by Liquibase, a changelog file will be created. Unlike the database-migration plugin the file is not written relative to the <code>grails-app/migrations</code> folder, it&#8217;s written relative to the application root directory. If the extension of the file is &#8220;sql&#8221;, a changelog will be generated but it will be used to by Liquibase to generate the SQL that would be created for the changelog and that SQL is written to the output file.</p>
</div>
<div class="paragraph">
<p>The liquibase-core jar or the database-migration plugin must be in the classpath to use this command.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-jdbc-sql">10.3. create-jdbc-sql</h3>
<div class="paragraph">
<div class="title">Purpose</div>
<p>Uses Hibernate to generate SQL to create Quartz database tables. The general format is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-jdbc-sql [FILENAME]</pre>
</div>
</div>
<div class="literalblock">
<div class="title">Examples</div>
<div class="content">
<pre>$ grails create-jdbc-sql quartz_jdbc.sql</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>Creates in-memory Hibernate model objects and returns the SQL generated from those; this is similar to the process used by the schema-export script. The hibernate-core jar or the hibernate plugin must be in the classpath to use this command.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0<br>
Last updated 2016-07-12 04:22:18 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>